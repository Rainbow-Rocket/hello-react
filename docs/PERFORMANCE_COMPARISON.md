# PDF vs WordViewer 性能对比分析

## 场景：国内访问香港服务器

### 性能对比

| 指标 | PDF Viewer | WordViewer (Office/Google) |
|------|------------|---------------------------|
| **初始加载** | ✅ 只需加载第一页（优化后） | ❌ 需要等待外部服务响应 |
| **总传输量** | ⚠️ 需要下载整个 PDF 文件 | ✅ 只传输渲染后的 HTML |
| **网络请求** | ✅ 1 个请求（香港服务器） | ❌ 2 个请求（香港 + 外部服务） |
| **国内访问** | ✅ 稳定，直接从香港加载 | ❌ 可能无法访问（被墙） |
| **加载速度** | ✅ 快（优化后分页加载） | ⚠️ 慢（依赖外部服务） |
| **用户体验** | ✅ 流畅，可控制 | ❌ 不稳定，可能失败 |
| **文件大小** | ⚠️ PDF 通常比 Word 大 20-30% | ✅ Word 文件较小 |

## 详细分析

### PDF Viewer 方案

**优势：**
1. ✅ **直接访问**：文件直接从香港服务器加载，不依赖外部服务
2. ✅ **稳定可靠**：不受网络环境限制，国内可正常访问
3. ✅ **可优化**：
   - 分页懒加载（只加载可见页面）
   - PDF 压缩优化
   - 缓存机制
4. ✅ **用户体验好**：加载快，交互流畅

**劣势：**
1. ⚠️ **文件大小**：PDF 文件通常比 Word 大 20-30%
2. ⚠️ **需要转换**：需要将 Word 转换为 PDF

**优化建议：**
- 使用 PDF 压缩工具（如 `ghostscript`）压缩文件
- 启用分页懒加载（已实现）
- 使用 CDN 加速（如果可用）

### WordViewer 方案

**优势：**
1. ✅ **文件小**：Word 文件通常比 PDF 小
2. ✅ **无需转换**：直接使用原始文件

**劣势：**
1. ❌ **依赖外部服务**：
   - Office Online Viewer：可能在国内无法访问
   - Google Docs Viewer：在国内被墙，无法使用
2. ❌ **额外网络请求**：需要先请求外部服务，再加载文档
3. ❌ **不稳定**：网络波动会影响加载
4. ❌ **隐私问题**：文档需要发送到第三方服务

## 推荐方案

### 🏆 **强烈推荐：PDF Viewer（已优化）**

**理由：**
1. **国内访问稳定**：不依赖可能被墙的外部服务
2. **性能更好**：分页懒加载，初始只加载第一页
3. **用户体验佳**：加载快，交互流畅
4. **可控性强**：完全控制加载和显示逻辑

**使用方式：**
```markdown
<!-- 启用懒加载（默认） -->
<Viewer uri="/documents/news/1.pdf" />

<!-- 禁用懒加载（一次性加载所有页面） -->
<Viewer uri="/documents/news/1.pdf" lazyLoad={false} />

<!-- 自定义每次加载页数 -->
<Viewer uri="/documents/news/1.pdf" pagesPerLoad={5} />
```

### PDF 文件优化建议

1. **压缩 PDF**：
   ```bash
   # 使用 ghostscript 压缩
   gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 \
      -dPDFSETTINGS=/screen -dNOPAUSE -dQUIET -dBATCH \
      -sOutputFile=output.pdf input.pdf
   ```

2. **Word 转 PDF 时选择"最小文件大小"选项**

3. **优化图片**：在 Word 中压缩图片后再转 PDF

## 性能数据估算

假设一个 2MB 的 Word 文档：

| 方案 | 初始加载 | 总传输量 | 加载时间（国内→香港） |
|------|---------|---------|---------------------|
| **PDF（优化）** | ~200KB（第一页） | 2.4MB | ~1-2秒 |
| **PDF（未优化）** | 2.4MB（全部） | 2.4MB | ~3-5秒 |
| **WordViewer** | 失败/很慢 | 未知 | 可能无法加载 |

## 结论

**对于国内访问香港服务器的场景，PDF Viewer 是最佳选择：**

1. ✅ 稳定可靠，不受网络限制
2. ✅ 性能优秀（分页懒加载）
3. ✅ 用户体验好
4. ✅ 完全可控

**WordViewer 不推荐的原因：**
- ❌ 国内可能无法访问外部服务
- ❌ 性能不稳定
- ❌ 用户体验差

## 实施建议

1. **将 Word 文档转换为 PDF**
2. **压缩 PDF 文件**（减少 30-50% 大小）
3. **使用优化后的 PDF Viewer**（已实现分页懒加载）
4. **考虑使用 CDN**（如果预算允许）

